<c:if xmlns:c="http://java.sun.com/jstl/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:nxh="http://nuxeo.org/nxweb/html"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:f="http://java.sun.com/jsf/core"
  test="#{contentView != null}">

<c:if test="false">
Needed parameters:
 - contentView: the content view instance
 - contentViewRenderId: unique identifier for this content view in the page
</c:if>

<!-- EasySOA: hide -->
<c:if test="#{false and contentView.showFilterForm and contentView.searchDocumentModel != null}">

  <div class="foldableLightBox">
    <c:set var="filterFormId" value="#{contentViewRenderId}_filterForm" />
    <nxu:set var="openBox" value="#{nxu:hasMessages(filterFormId)}"
      cache="true">

      <div class="foldableLightBoxHeader #{nxu:test(openBox, 'unfolded', 'folded')}">
        <a href="#nologo" onclick="return toggleBox(this)">
          <h:outputText value="#{messages['label.contentview.filter.title']}"/>
        </a>
        <div class="action_bar_message">
          <a4j:form id="#{contentViewRenderId}_resetFilterForm"
            ajaxSubmit="true">
            <a4j:commandLink
              value="#{messages['label.contentview.filter.clearFilter']}"
              id="#{contentViewRenderId}_resetFilterSubmit"
              ajaxSingle="true"
              rendered="#{nxd:isDirty(contentView.searchDocumentModel)}"
              reRender="#{contentViewRenderId}_resultsPanel, #{contentViewRenderId}_resetFilterForm, #{contentViewRenderId}_filterForm"
              oncomplete="initNXDrapAndDropOnPage(jQuery('#' + '#{contentViewRenderId}_panel'));"
              styleClass="button warningLink">
              <nxu:actionListenerMethod
                value="#{contentView.resetSearchDocumentModel()}" />
            </a4j:commandLink>
          </a4j:form>
        </div>
      </div>

    </nxu:set>
    <div class="boxBody"
      style="#{nxu:test(openBox, '', 'overflow: visible; display: none;')}">
      <a4j:form id="#{contentViewRenderId}_filterForm">
        <nxl:layout name="#{contentView.searchLayout.name}" mode="edit"
          value="#{contentView.searchDocumentModel}" />
        <p class="buttonsGadget">
          <a4j:commandButton
            value="#{messages['label.contentview.filter.filterAction']}"
            id="#{contentViewRenderId}_filterSubmit"
            reRender="#{contentViewRenderId}_resultsPanel, #{contentViewRenderId}_resetFilterForm, #{contentViewRenderId}_filterForm"
            oncomplete="initNXDrapAndDropOnPage(jQuery('#' + '#{contentViewRenderId}_panel'));"
            styleClass="button">
            <nxu:actionListenerMethod
              value="#{contentView.resetPageProvider()}" />
          </a4j:commandButton>
          <a4j:commandButton
            value="#{messages['label.contentview.filter.clearFilterButton']}"
            id="#{contentViewRenderId}_filterClear"
            immediate="true" ajaxSingle="true"
            reRender="#{contentViewRenderId}_resultsPanel, #{contentViewRenderId}_resetFilterForm, #{contentViewRenderId}_filterForm"
            oncomplete="initNXDrapAndDropOnPage(jQuery('#' + '#{contentViewRenderId}_panel'));"
            styleClass="button">
            <nxu:actionListenerMethod
              value="#{contentView.resetSearchDocumentModel()}" />
          </a4j:commandButton>
        </p>
      </a4j:form>
    </div>
  </div>
</c:if>

</c:if>